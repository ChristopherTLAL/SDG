---
// src/pages/future-scholars-program.astro
import MainLayout from '../layouts/MainLayout.astro'; // 同样导入主模板

---

<MainLayout title="未来学者计划">
    <main class="container mx-auto px-6 py-16 md:py-24">
        <section class="text-center mb-24 md:mb-32">
            <h1 class="text-4xl md:text-6xl font-extrabold text-gray-900 dark:text-white mb-6 reveal">未来学者计划</h1>
            <p class="max-w-3xl mx-auto text-lg md:text-xl text-gray-600 dark:text-gray-300 reveal" style="transition-delay: 150ms;">
                这不仅是一项留学申请服务，更是一场通往世界顶尖学术殿堂的深度陪跑。我们坚信，最好的申请，源于最真实的成长。
            </p>
            <blockquote class="border-l-4 border-blue-500 pl-8 italic text-gray-700 dark:text-gray-300 text-left max-w-3xl mx-auto text-xl mt-8 reveal">
                "我们不制造完美的申请机器，而是发掘和培养独立的思考者与未来的变革者。我们的教育理念根植于可持续发展的宏大叙事，旨在引导学生将个人学术追求与解决全球性挑战相结合，让每一次成长都有迹可循，让每一份申请都言之有物。"
            </blockquote>
        </section>
        
        <!-- Services Section -->
        <section id="services" class="mb-24 md:mb-32 text-center">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white reveal">为你量身打造的方案</h2>
            <p class="text-lg text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mt-4 reveal" style="transition-delay: 150ms;">留学申请是一个复杂的系统工程。我们的服务体系旨在覆盖从长期准备到最终录取的每一个关键环节，确保你始终走在正确的道路上。</p>
            
            <div class="grid md:grid-cols-3 gap-8 mt-16 text-left">
                <div class="bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700/50 rounded-2xl p-8 shadow-sm hover:shadow-xl transition-shadow duration-300 reveal">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white">启航·早鸟规划</h3>
                    <p class="text-gray-600 dark:text-gray-400 text-base mt-2">适合低年级学生，着眼于长期的竞争力构建，为未来的名校申请打下坚实基础。</p>
                    <button onclick="App.openModal('planningModal')" class="w-full mt-6 text-center py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-sm font-medium transition-colors">查看详情</button>
                </div>
                <div class="bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700/50 rounded-2xl p-8 shadow-sm hover:shadow-xl transition-shadow duration-300 reveal" style="transition-delay: 150ms;">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white">筑梦·名校申请</h3>
                    <p class="text-gray-600 dark:text-gray-400 text-base mt-2">适合已进入申请季的学生，提供一站式服务，精准高效地完成申请，冲刺梦想学校。</p>
                    <button onclick="App.openModal('applicationModal')" class="w-full mt-6 text-center py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-sm font-medium transition-colors">查看详情</button>
                </div>
                <div class="bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700/50 rounded-2xl p-8 shadow-sm hover:shadow-xl transition-shadow duration-300 reveal" style="transition-delay: 300ms;">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white">登峰·博士申请</h3>
                    <p class="text-gray-600 dark:text-gray-400 text-base mt-2">学术生涯的顶峰之战，提供覆盖全流程的深度支持，助你敲开顶尖学术殿堂的大门。</p>
                    <button onclick="App.openModal('phdModal')" class="w-full mt-6 text-center py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-sm font-medium transition-colors">查看详情</button>
                </div>
            </div>
        </section>
        
        <!-- Calculator Section -->
        <section id="calculator" class="mb-24 md:mb-32">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white reveal">定制你的专属方案</h2>
                <p class="text-lg text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mt-4 reveal" style="transition-delay: 150ms;">通过下面的选项，实时计算你的留学服务方案与费用。</p>
            </div>
            <div class="bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700/50 rounded-3xl p-8 md:p-12 shadow-lg grid lg:grid-cols-2 gap-12 reveal">
                <!-- Left: Controls -->
                <div class="space-y-8">
                    <div>
                        <label class="font-semibold text-gray-800 dark:text-gray-200">申请阶段</label>
                        <div id="stage" class="grid grid-cols-3 gap-4 mt-2">
                            <button data-value="undergrad" class="stage-btn bg-blue-500 text-white rounded-lg py-2">本科</button>
                            <button data-value="masters" class="stage-btn bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg py-2">硕士</button>
                            <button data-value="phd" class="stage-btn bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg py-2">博士</button>
                        </div>
                    </div>
                    <div>
                        <label for="currentGrade" class="font-semibold text-gray-800 dark:text-gray-200">目前就读年级</label>
                        <select id="currentGrade" class="mt-2 block w-full bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                            <!-- Options will be dynamically populated by JS -->
                        </select>
                    </div>
                    <div>
                        <label class="font-semibold text-gray-800 dark:text-gray-200">申请地区</label>
                        <div id="region" class="grid grid-cols-3 gap-4 mt-2">
                            <button data-value="commonwealth" class="region-btn bg-blue-500 text-white rounded-lg py-2">英联邦</button>
                            <button data-value="usa" class="region-btn bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg py-2">美国</button>
                            <button data-value="global" class="region-btn bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg py-2">全球联申</button>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="schoolCount" class="font-semibold text-gray-800 dark:text-gray-200">申请院校数量</label>
                            <span id="schoolCountLabel" class="font-bold text-blue-600 dark:text-blue-400 text-lg">10</span>
                        </div>
                        <input type="range" id="schoolCount" min="1" max="30" value="10" class="mt-2">
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">建议：滑块颜色越深，代表越多学生选择该范围。</p>
                    </div>
                    <div>
                        <label class="font-semibold text-gray-800 dark:text-gray-200">额外服务</label>
                        <div id="extraServices" class="mt-2 space-y-2">
                            <!-- Extra services will be populated by JS -->
                        </div>
                    </div>
                </div>
                <!-- Right: Summary -->
                <div class="bg-gray-50 dark:bg-gray-700/50 rounded-2xl p-8 flex flex-col">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white">你的专属方案</h3>
                    <div id="serviceList" class="flex-grow mt-6 space-y-4 text-gray-700 dark:text-gray-300">
                        <!-- Service items will be injected here -->
                    </div>
                    <div class="border-t border-gray-200 dark:border-gray-600 pt-6 mt-6">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-lg font-semibold text-gray-800 dark:text-gray-200">预估总费用</span>
                            <span id="totalPrice" class="text-4xl font-bold text-gray-900 dark:text-white">¥0</span>
                        </div>
                        <button onclick="App.openModal('wechatModal')" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition-colors">生成方案并咨询</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Mentors Section -->
        <section id="mentors" class="mb-24 md:mb-32">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white text-center reveal">精英导师团队</h2>
            <p class="text-lg text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mt-4 text-center reveal" style="transition-delay: 150ms;">我们的导师均毕业于世界顶尖名校，拥有丰富的学术研究与指导经验。</p>
            <div class="horizontal-scroll-container mt-16 space-x-8">
                <!-- Mentor Cards -->
                <div class="w-64 flex-shrink-0 text-center reveal">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1580894742597-87bc8789db3d?q=80&w=400&auto=format&fit=crop" alt="Dr. Evelyn Reed">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. Evelyn Reed</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">社会学博士</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">剑桥大学</p>
                </div>
                <div class="w-64 flex-shrink-0 text-center reveal" style="transition-delay: 100ms;">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=400&auto=format&fit=crop" alt="Dr. Kenji Tanaka">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. Kenji Tanaka</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">人工智能与伦理学</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">麻省理工学院</p>
                </div>
                <div class="w-64 flex-shrink-0 text-center reveal" style="transition-delay: 200ms;">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1542740348-395018373567?q=80&w=400&auto=format&fit=crop" alt="Dr. Isabella Rossi">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. Isabella Rossi</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">经济学博士</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">伦敦政治经济学院</p>
                </div>
                <div class="w-64 flex-shrink-0 text-center reveal" style="transition-delay: 300ms;">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1599566150163-29194dcaad36?q=80&w=400&auto=format&fit=crop" alt="Dr. Marcus Chen">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. Marcus Chen</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">环境科学博士</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">斯坦福大学</p>
                </div>
                <div class="w-64 flex-shrink-0 text-center reveal" style="transition-delay: 400ms;">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?q=80&w=400&auto=format&fit=crop" alt="Dr. Fatima Al-Jamil">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. Fatima Al-Jamil</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">公共政策硕士</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">牛津大学</p>
                </div>
                    <div class="w-64 flex-shrink-0 text-center reveal" style="transition-delay: 500ms;">
                    <img class="w-32 h-32 rounded-full mx-auto object-cover" src="https://images.unsplash.com/photo-1560250097-0b93528c311a?q=80&w=400&auto=format&fit=crop" alt="Dr. David Lee">
                    <h4 class="font-bold text-lg mt-4 text-gray-900 dark:text-white">Dr. David Lee</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">计算机科学博士</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">加州大学伯克利分校</p>
                </div>
            </div>
        </section>

        <!-- Cases Section -->
        <section id="cases" class="mb-24 md:mb-32">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white text-center reveal">听听他们怎么说</h2>
            <div class="horizontal-scroll-container mt-16 space-x-8">
                <!-- Case Cards -->
                <div class="w-72 flex-shrink-0 aspect-[9/16] relative rounded-2xl overflow-hidden shadow-lg reveal">
                    <img src="https://placehold.co/360x640/2d3748/ffffff?text=UCL+Offer" alt="UCL Offer" class="absolute inset-0 w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 p-6 text-white">
                        <p>"感谢老师在我迷茫时的指导，文书打磨得非常专业，逻辑和深度都提升了好几个层次。最终拿到UCL的Offer，真的超乎想象！"</p>
                        <div class="mt-4 font-semibold text-sm">王同学 — 录取: 伦敦大学学院</div>
                    </div>
                </div>
                    <div class="w-72 flex-shrink-0 aspect-[9/16] relative rounded-2xl overflow-hidden shadow-lg reveal" style="transition-delay: 100ms;">
                    <img src="https://placehold.co/360x640/4a5568/ffffff?text=Columbia+Offer" alt="Columbia Offer" class="absolute inset-0 w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 p-6 text-white">
                        <p>"背景提升规划非常到位，老师推荐的软著项目和实习，让我的简历在众多申请者中脱颖而出，这是我能被哥大录取的重要原因。"</p>
                        <div class="mt-4 font-semibold text-sm">李同学 — 录取: 哥伦比亚大学</div>
                    </div>
                </div>
                    <div class="w-72 flex-shrink-0 aspect-[9/16] relative rounded-2xl overflow-hidden shadow-lg reveal" style="transition-delay: 200ms;">
                    <img src="https://placehold.co/360x640/718096/ffffff?text=Oxford+Offer" alt="Oxford Offer" class="absolute inset-0 w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 p-6 text-white">
                        <p>"博士申请的套磁环节太关键了。老师帮我筛选的导师列表和修改的套磁信，回复率非常高，为后续的面试铺平了道路。"</p>
                        <div class="mt-4 font-semibold text-sm">张同学 — 录取: 牛津大学</div>
                    </div>
                </div>
                    <div class="w-72 flex-shrink-0 aspect-[9/16] relative rounded-2xl overflow-hidden shadow-lg reveal" style="transition-delay: 300ms;">
                    <img src="https://placehold.co/360x640/a0aec0/000000?text=ETH+Zurich+Offer" alt="ETH Zurich Offer" class="absolute inset-0 w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 p-6 text-white">
                        <p>"从一个模糊的想法到一份完整的研究计划，老师的指导让我对自己的研究方向有了前所未有的清晰认识，这比拿到Offer本身更宝贵。"</p>
                        <div class="mt-4 font-semibold text-sm">陈同学 — 录取: 苏黎世联邦理工学院</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Final CTA -->
        <section class="text-center py-20 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700/50 rounded-3xl reveal">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white">准备好开启你的学术之旅了吗？</h2>
            <p class="text-gray-600 dark:text-gray-400 max-w-xl mx-auto my-6">如果你希望得到专业、个性化的指导，欢迎随时与我联系。我们可以一起聊聊你的目标和困惑，并为你规划下一步的行动。</p>
            <button onclick="App.openModal('wechatModal')" class="bg-blue-600 text-white font-semibold px-8 py-3 rounded-full text-base hover:bg-blue-700 transition-all duration-300 transform hover:scale-105">预约免费咨询</button>
        </section>
    </main>
    
    <!-- Modals -->
    <div id="wechatModal" class="fixed inset-0 z-[100] items-center justify-center p-4" style="display: none;">
        <div class="modal-backdrop fixed inset-0 bg-black/60 dark:bg-black/80" onclick="App.closeModal('wechatModal')"></div>
        <div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-sm text-center p-8 relative">
            <button onclick="App.closeModal('wechatModal')" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 dark:hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold mb-2 text-gray-900 dark:text-white">扫码添加顾问微信</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-6">即刻开启免费评估</p>
            <img src="https://placehold.co/256x256/f5f5f7/1d1d1f?text=QR+Code" alt="微信二维码" class="w-64 h-64 mx-auto rounded-lg bg-gray-100" onerror="this.onerror=null;this.src='https://placehold.co/256x256/f5f5f7/1d1d1f?text=Image+Error';">
        </div>
    </div>

    <div id="planningModal" class="fixed inset-0 z-[100] items-center justify-center p-4" style="display: none;">
        <div class="modal-backdrop fixed inset-0 bg-black/60 dark:bg-black/80" onclick="App.closeModal('planningModal')"></div>
        <div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-5xl p-8 max-h-[90vh] overflow-y-auto relative">
            <button onclick="App.closeModal('planningModal')" class="absolute top-6 right-6 text-gray-400 hover:text-gray-800 dark:hover:text-white text-3xl z-10">&times;</button>
            <div class="grid lg:grid-cols-2 gap-12">
                <div class="lg:col-span-1">
                    <h4 class="font-semibold text-xl mb-2 text-gray-900 dark:text-white">早鸟规划方案</h4>
                    <div class="text-center mb-4 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                        <p class="text-4xl font-bold text-gray-900 dark:text-white">¥9,000<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/年</span></p>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">年度动态规划与背景提升</p>
                    </div>
                    <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50"><canvas id="radarChart"></canvas></div>
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">以牛津大学PPE专业要求为例，对比当前能力与目标差距</p>
                </div>
                <div class="lg:col-span-1 space-y-8">
                    <div>
                        <h4 class="font-semibold text-xl mb-4 text-gray-900 dark:text-white">核心服务内容</h4>
                        <ul class="space-y-3 text-gray-600 dark:text-gray-300">
                            <li class="flex items-start"><span class="text-blue-500 mr-3 mt-1.5">&#10003;</span><span><b>年度规划方案:</b> 根据五大维度进行长期、动态的背景提升规划。</span></li>
                            <li class="flex items-start"><span class="text-blue-500 mr-3 mt-1.5">&#10003;</span><span><b>独家背景提升资源 (4选1):</b> 见下文详解，每年可任选其一。</span></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-xl mb-4 text-gray-900 dark:text-white">独家背景提升资源</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="resource-gallery-item" onclick="App.openResourceModal('coursera')"><img src="../../public/Coursera" alt="数据分析仪表盘的图片" onerror="this.onerror=null;this.src='https://placehold.co/400x400/f5f5f7/1d1d1f?text=Data';"><div><span>Coursera 证书</span><span class="arrow">&rarr;</span></div></div>
                            <div class="resource-gallery-item" onclick="App.openResourceModal('software')"><img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=800&auto=format&fit=crop" alt="开发者在电脑前编程的图片" onerror="this.onerror=null;this.src='https://placehold.co/400x400/f5f5f7/1d1d1f?text=Code';"><div><span>软件著作权</span><span class="arrow">&rarr;</span></div></div>
                            <div class="resource-gallery-item" onclick="App.openResourceModal('monograph')"><img src="https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?q=80&w=800&auto=format&fit=crop" alt="图书馆中书架的图片" onerror="this.onerror=null;this.src='https://placehold.co/400x400/f5f5f7/1d1d1f?text=Book';"><div><span>英文专著发表</span><span class="arrow">&rarr;</span></div></div>
                            <div class="resource-gallery-item" onclick="App.openResourceModal('internship')"><img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?q=80&w=800&auto=format&fit=crop" alt="现代办公室中人们协作的图片" onerror="this.onerror=null;this.src='https://placehold.co/400x400/f5f5f7/1d1d1f?text=Team';"><div><span>企业实习</span><span class="arrow">&rarr;</span></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="applicationModal" class="fixed inset-0 z-[100] items-center justify-center p-4" style="display: none;">
        <div class="modal-backdrop fixed inset-0 bg-black/60 dark:bg-black/80" onclick="App.closeModal('applicationModal')"></div>
        <div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-6xl p-8 max-h-[90vh] overflow-y-auto relative">
             <button onclick="App.closeModal('applicationModal')" class="absolute top-6 right-6 text-gray-400 hover:text-gray-800 dark:hover:text-white text-3xl z-10">&times;</button>
             <div class="grid lg:grid-cols-5 gap-x-12 gap-y-8">
                 <div class="lg:col-span-3">
                     <h4 class="font-semibold text-xl mb-6 text-gray-900 dark:text-white">价格方案</h4>
                     <div class="mb-8">
                         <h5 class="font-bold text-lg mb-3 text-gray-900 dark:text-white">本科申请</h5>
                         <div class="overflow-x-auto">
                             <table class="w-full text-left">
                                 <thead class="text-gray-500 dark:text-gray-400 text-sm border-b border-gray-200 dark:border-gray-700">
                                     <tr><th class="p-3 font-medium">地区</th><th class="p-3 font-medium">院校数</th><th class="p-3 font-medium text-right">价格 (RMB)</th></tr>
                                 </thead>
                                 <tbody class="text-gray-800 dark:text-gray-200">
                                     <tr class="border-b border-gray-200 dark:border-gray-700"><td class="p-3">英联邦</td><td class="p-3">10个</td><td class="p-3 text-right font-mono">29,800</td></tr>
                                     <tr class="border-b border-gray-200 dark:border-gray-700"><td class="p-3">美国</td><td class="p-3">10个</td><td class="p-3 text-right font-mono">58,000</td></tr>
                                     <tr><td class="p-3">全球联申 (英联邦+北美)</td><td class="p-3">各10个</td><td class="p-3 text-right font-mono">75,000</td></tr>
                                 </tbody>
                             </table>
                         </div>
                         <div class="mt-4 p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800/50 rounded-xl">
                             <div class="flex items-start">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600 dark:text-green-400 mr-3 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                                 <div>
                                     <h6 class="font-semibold text-green-800 dark:text-green-200">限时礼遇</h6>
                                     <p class="text-sm text-green-700 dark:text-green-300 mt-1">
                                         所有本科申请合同均赠与一年规划服务（价值 9,000 元），以学生的申请目标为中心，安排专业证书、行业实习、英文发表、软件著作四选一的背景提升项目。
                                     </p>
                                 </div>
                             </div>
                         </div>
                     </div>
                     <div class="mb-8">
                         <h5 class="font-bold text-lg mb-3 text-gray-900 dark:text-white">研究生申请</h5>
                         <div class="overflow-x-auto">
                             <table class="w-full text-left">
                                 <thead class="text-gray-500 dark:text-gray-400 text-sm border-b border-gray-200 dark:border-gray-700">
                                     <tr><th class="p-3 font-medium">地区</th><th class="p-3 font-medium">院校数</th><th class="p-3 font-medium text-right">价格 (RMB)</th></tr>
                                 </thead>
                                 <tbody class="text-gray-800 dark:text-gray-200">
                                     <tr class="border-b border-gray-200 dark:border-gray-700"><td class="p-3">英联邦</td><td class="p-3">7个</td><td class="p-3 text-right font-mono">19,800</td></tr>
                                     <tr><td class="p-3">美国</td><td class="p-3">10个</td><td class="p-3 text-right font-mono">39,800</td></tr>
                                 </tbody>
                             </table>
                         </div>
                     </div>
                     <p class="text-xs text-gray-500 dark:text-gray-400 mt-4">* 每增加一个申请院校/专业，额外收取 1,000 元。</p>
                 </div>
                 <div class="lg:col-span-2">
                     <h4 class="font-semibold text-xl mb-6 text-gray-900 dark:text-white">标准服务流程 (SOP)</h4>
                     <div class="flex flex-col">
                         <!-- SOP Steps -->
                         <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                             <h5 class="font-semibold text-gray-900 dark:text-white">1. 策略制定</h5>
                             <div class="flex flex-wrap gap-2 mt-2">
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">背景评估</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">选校定位</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">考试规划</span>
                             </div>
                         </div>
                         <div class="h-6 w-px bg-gray-300 dark:bg-gray-600 self-center"></div>
                         <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                             <h5 class="font-semibold text-gray-900 dark:text-white">2. 文书创作</h5>
                              <div class="flex flex-wrap gap-2 mt-2">
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">头脑风暴</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">结构搭建</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">内容指导</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">CV/Resume</span>
                             </div>
                         </div>
                         <div class="h-6 w-px bg-gray-300 dark:bg-gray-600 self-center"></div>
                         <div class="p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800/50 rounded-xl">
                             <h5 class="font-semibold text-blue-700 dark:text-blue-300">3. 质量监控</h5>
                              <div class="flex flex-wrap gap-2 mt-2">
                                 <span class="text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full">外籍专家润色</span>
                                 <span class="text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full">AI查重</span>
                                 <span class="text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full">终稿确认</span>
                             </div>
                         </div>
                         <div class="h-6 w-px bg-gray-300 dark:bg-gray-600 self-center"></div>
                         <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                             <h5 class="font-semibold text-gray-900 dark:text-white">4. 申请执行</h5>
                              <div class="flex flex-wrap gap-2 mt-2">
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">网申填写</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">材料打包</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">推荐信策略</span>
                             </div>
                         </div>
                         <div class="h-6 w-px bg-gray-300 dark:bg-gray-600 self-center"></div>
                         <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl">
                             <h5 class="font-semibold text-gray-900 dark:text-white">5. 录取支持</h5>
                              <div class="flex flex-wrap gap-2 mt-2">
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">面试指导</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">Offer选择</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">签证指导</span>
                                 <span class="text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-2 py-1 rounded-full">行前准备</span>
                             </div>
                         </div>
                     </div>
                      <p class="text-xs text-gray-500 dark:text-gray-400 mt-6">*重要说明: 服务不含学术文本翻译/撰写及公证材料办理。</p>
                 </div>
              </div>
        </div>
    </div>
    
    <div id="phdModal" class="fixed inset-0 z-[100] items-center justify-center p-4" style="display: none;">
        <div class="modal-backdrop fixed inset-0 bg-black/60 dark:bg-black/80" onclick="App.closeModal('phdModal')"></div>
        <div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-6xl p-8 max-h-[90vh] overflow-y-auto relative">
             <button onclick="App.closeModal('phdModal')" class="absolute top-6 right-6 text-gray-400 hover:text-gray-800 dark:hover:text-white text-3xl z-10">&times;</button>
             <div class="grid lg:grid-cols-5 gap-x-12 gap-y-8">
                <div class="lg:col-span-2">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white">博士全方位申请</h3>
                    <p class="text-gray-600 dark:text-gray-400 mt-2">博士申请是学术生涯的顶峰之战。我们提供覆盖全流程的深度支持，从精准的导师匹配到研究计划的打磨，助你敲开顶尖学术殿堂的大门。</p>
                    
                    <h4 class="font-semibold text-lg mt-6 mb-3 text-gray-900 dark:text-white">套餐内含背景提升资源</h4>
                    <ul class="space-y-2 text-gray-700 dark:text-gray-300">
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>软件著作权</li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>英文书籍发表</li>
                        <li class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>Coursera 专业证书</li>
                    </ul>

                    <div class="mt-6">
                        <div class="p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center">
                                <span class="font-semibold text-gray-800 dark:text-gray-200">核心服务套餐</span>
                                <span class="font-mono text-xl font-bold text-gray-900 dark:text-white">39,800</span>
                            </div>
                        </div>
                        <div class="mt-3 p-4 bg-indigo-50 dark:bg-indigo-900/30 border border-indigo-200 dark:border-indigo-800/50 rounded-xl">
                            <div class="flex items-start">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-3 flex-shrink-0 mt-0.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path></svg>
                                <div>
                                    <h6 class="font-semibold text-indigo-800 dark:text-indigo-200">可选：研究计划 (RP) 深度辅导</h6>
                                    <p class="text-sm text-indigo-700 dark:text-indigo-300 mt-1">
                                        由对口专业导师提供一对一深度辅导。
                                        <span class="block mt-1 font-semibold">¥650/小时 (建议时长 20 小时)</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="lg:col-span-3">
                    <h4 class="font-semibold text-lg mb-4 text-gray-900 dark:text-white">博士申请标准服务流程 (SOP)</h4>
                    <div class="flex flex-col space-y-3">
                        <div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"><h5 class="font-semibold text-gray-800 dark:text-gray-200">1. 策略规划</h5><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">学术背景深挖、研究兴趣探索、全球导师数据库筛选</p></div>
                        <div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"><h5 class="font-semibold text-gray-800 dark:text-gray-200">2. 学术套磁</h5><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">导师套磁 (80-100封)、学术面试模拟、沟通技巧培训</p></div>
                        <div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"><h5 class="font-semibold text-gray-800 dark:text-gray-200">3. 研究计划 (RP)</h5><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">选题与创新点挖掘、框架与方法论搭建、初稿指导</p></div>
                        <div class="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"><h5 class="font-semibold text-gray-800 dark:text-gray-200">4. 核心文书</h5><p class="text-sm text-gray-600 dark:text-gray-400 mt-1">CV, Personal Statement, Statement of Purpose, Writing Sample 指导</p></div>
                        <div class="p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800/50 rounded-lg"><h5 class="font-semibold text-blue-700 dark:text-blue-300">5. 申请冲刺</h5><p class="text-sm text-blue-600 dark:text-blue-400 mt-1">网申与材料递交、奖学金申请策略、录取后决策支持</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="resourceModal" class="fixed inset-0 z-[110] items-center justify-center p-4" style="display: none;">
        <div class="modal-backdrop fixed inset-0 bg-black/60 dark:bg-black/80" onclick="App.closeModal('resourceModal')"></div>
        <div class="modal-content bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-4xl p-8 max-h-[90vh] overflow-y-auto relative">
            <button onclick="App.closeModal('resourceModal')" class="absolute top-6 right-6 text-gray-400 hover:text-gray-800 dark:hover:text-white text-3xl z-10">&times;</button>
            <h2 id="resourceTitle" class="text-3xl font-bold mb-8 text-gray-900 dark:text-white">资源详情</h2>
            <div id="resourceContent" class="space-y-8 text-gray-700 dark:text-gray-300"></div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script is:inline>
    const App = (() => {
        let radarChartInstance = null;

        const resourceData = {
            coursera: {
                title: 'Coursera 专业证书',
                content: `<div class="resource-section"><img src="public/CourseraCertificate.png" alt="人工智能概念的图片"><div class="text-content"><h3>对接世界名校在线课程</h3><p class="text-gray-600 dark:text-gray-400">我们为您筛选并推荐来自Google、IBM、斯坦福等顶尖企业和大学的在线证书课程，提前修读专业知识，提升学术竞争力，并可写入LinkedIn档案，获得全球认可。</p></div></div><div class="resource-section"><img src="public/CourseraLinkedIn.jpg" alt="专业人士档案页面的图片"><div class="text-content"><h3>提升职业竞争力</h3><p class="text-gray-600 dark:text-gray-400">获得的证书可以直接关联到您的LinkedIn个人资料，向全球的招生官和雇主展示您的专业技能和学习热情。热门证书如吴恩达的《AI For Everyone》、Google的《数据分析专业证书》等，都是申请相关专业时的有力加分项。</p></div></div>`
            },
            software: { 
                title: '软件著作权', 
                content: `<div class="resource-section"><img src="https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?q=80&w=800&auto=format&fit=crop" alt="开发者在编写代码"><div class="text-content"><h3>技术创新能力的体现</h3><p class="text-gray-600 dark:text-gray-400">对于申请计算机、数据科学等技术类专业的学生，一份软件著作权是证明你具备独立开发能力和创新思维的硬核材料。我们将指导你完成一个与申请方向相关的小项目，并协助完成软著的申请全流程。</p></div></div><div class="resource-section"><img src="https://images.unsplash.com/photo-1526628953301-3e589a6a8b74?q=80&w=800&auto=format&fit=crop" alt="证书和文件的图片"><div class="text-content"><h3>官方认证，永久有效</h3><p class="text-gray-600 dark:text-gray-400">软件著作权由国家版权局认证，是受法律保护的知识产权。它不仅是你申请时的亮点，更是你未来职业生涯中的宝贵资产。</p></div></div>`
            },
            monograph: { 
                title: '英文专著发表', 
                content: `<div class="resource-section"><img src="https://images.unsplash.com/photo-1491841550275-5b462bf975db?q=80&w=800&auto=format&fit=crop" alt="一本打开的厚书"><div class="text-content"><h3>学术深度的终极证明</h3><p class="text-gray-600 dark:text-gray-400">参与发表一本英文专著（担任其中一个章节的作者），是向顶尖名校展示你学术研究能力的最佳方式。尤其适合申请研究型硕士或博士的学生。我们与海外出版社合作，提供正规的出版渠道。</p></div></div><div class="resource-section"><img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=800&auto=format&fit=crop" alt="学术研究团队在讨论"><div class="text-content"><h3>全程导师指导</h3><p class="text-gray-600 dark:text-gray-400">你将在专业导师的指导下，完成选题、文献综述、研究和写作过程。这不仅是一次背景提升，更是一次宝贵的学术训练经历。</p></div></div>`
            },
            internship: { 
                title: '名企实习与推荐信', 
                content: `<div class="resource-section"><img src="https://images.unsplash.com/photo-1556761175-5973dc0f32e7?q=80&w=800&auto=format&fit=crop" alt="商务人士在会议中握手"><div class="text-content"><h3>链接行业顶尖资源</h3><p class="text-gray-600 dark:text-gray-400">我们将利用我们的合作网络，为你推荐在知名企业（如咨询、投行、科技公司等）的实习机会。一段高质量的实习经历能极大丰富你的简历，让你提前了解行业运作。</p></div></div><div class="resource-section"><img src="https://images.unsplash.com/photo-1516321497487-e288fb19713f?q=80&w=800&auto=format&fit=crop" alt="一封专业的推荐信"><div class="text-content"><h3>获得高含金量推荐信</h3><p class="text-gray-600 dark:text-gray-400">实习结束后，表现优异者将有机会获得由实习导师或公司高管出具的推荐信。这封来自业界的推荐信，将从不同角度印证你的能力和潜力，是申请商科、金融等实践性专业的重要加分项。</p></div></div>`
            }
        };

        const _initRadarChart = () => {
            const ctx = document.getElementById('radarChart');
            if (!ctx) return;

            const isDark = document.documentElement.classList.contains('dark');
            const gridColor = isDark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.1)';
            const angleLineColor = isDark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.1)';
            const pointLabelColor = isDark ? 'rgba(255, 255, 255, 0.8)' : 'rgba(0, 0, 0, 0.8)';

            const data = {
                labels: ['学术成绩', '研究经历', '语言能力', '课外活动', '领导力'],
                datasets: [{
                    label: '当前能力',
                    data: [75, 50, 85, 65, 70],
                    fill: true,
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    borderColor: 'rgb(59, 130, 246)',
                    pointBackgroundColor: 'rgb(59, 130, 246)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(59, 130, 246)'
                }, {
                    label: '目标要求',
                    data: [90, 70, 95, 80, 75],
                    fill: true,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgb(255, 99, 132)',
                    pointBackgroundColor: 'rgb(255, 99, 132)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(255, 99, 132)'
                }]
            };

            if (radarChartInstance) {
                radarChartInstance.destroy();
            }

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    elements: {
                        line: {
                            borderWidth: 2
                        }
                    },
                    scales: {
                        r: {
                            angleLines: { color: angleLineColor },
                            grid: { color: gridColor },
                            pointLabels: { color: pointLabelColor, font: { size: 12 } },
                            ticks: {
                                color: pointLabelColor,
                                backdropColor: 'transparent'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: pointLabelColor
                            }
                        }
                    }
                }
            });
        };

        const openModal = (modalId) => {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            
            const backdrop = modal.querySelector('.modal-backdrop');
            const content = modal.querySelector('.modal-content');

            modal.style.display = 'flex';
            setTimeout(() => {
                if (backdrop) backdrop.style.opacity = 1;
                if (content) {
                    content.style.opacity = 1;
                    content.style.transform = 'scale(1)';
                }
            }, 10);

            if (modalId === 'planningModal') {
                _initRadarChart();
            }
        };

        const closeModal = (modalId) => {
            const modal = document.getElementById(modalId);
            if (!modal) return;

            const backdrop = modal.querySelector('.modal-backdrop');
            const content = modal.querySelector('.modal-content');

            if (backdrop) backdrop.style.opacity = 0;
            if (content) {
                content.style.opacity = 0;
                content.style.transform = 'scale(0.95)';
            }
            
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        };

        const openResourceModal = (resourceId) => {
            const data = resourceData[resourceId];
            if (!data) return;

            document.getElementById('resourceTitle').innerText = data.title;
            document.getElementById('resourceContent').innerHTML = data.content;
            openModal('resourceModal');
        };

        // Dark mode listener for chart redraw
        const themeObserver = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                const modal = document.getElementById('planningModal');
                if (modal && mutation.attributeName === "class" && modal.style.display === 'flex') {
                    _initRadarChart();
                }
            });
        });
        
        document.addEventListener('DOMContentLoaded', () => {
             themeObserver.observe(document.documentElement, { attributes: true });
        });

        return { openModal, closeModal, openResourceModal };
    })();

    document.addEventListener('DOMContentLoaded', () => {
        // --- Dark Mode Auto-Toggle ---
        const applyTheme = (isDark) => {
            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        };

        const matcher = window.matchMedia('(prefers-color-scheme: dark)');
        applyTheme(matcher.matches);
        matcher.addEventListener('change', e => applyTheme(e.matches));
        
        // --- Scroll Reveal Animation ---
        const revealElements = document.querySelectorAll('.reveal');
        const scrollObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('reveal-visible');
                }
            });
        }, {
            threshold: 0.1
        });

        revealElements.forEach(el => {
            scrollObserver.observe(el);
        });

        // --- Calculator Logic ---
        const calculator = {
            // Elements
            stageBtns: document.querySelectorAll('.stage-btn'),
            currentGradeSelect: document.getElementById('currentGrade'),
            regionBtns: document.querySelectorAll('.region-btn'),
            schoolCountSlider: document.getElementById('schoolCount'),
            schoolCountLabel: document.getElementById('schoolCountLabel'),
            extraServicesContainer: document.getElementById('extraServices'),
            serviceList: document.getElementById('serviceList'),
            totalPrice: document.getElementById('totalPrice'),

            // Config
            config: {
                planningPerYear: 9000,
                extraSchool: 1000,
                extraServices: {
                    rpCoaching: { label: '研究计划 (RP) 深度辅导', price: 13000 }
                },
                stages: {
                    undergrad: {
                        label: '本科',
                        targetApplicationYear: 12,
                        grades: [
                            { value: 7, label: '初一' }, { value: 8, label: '初二' },
                            { value: 9, label: '初三' }, { value: 10, label: '高一' },
                            { value: 11, label: '高二' }, { value: 12, label: '高三' }
                        ],
                        regions: {
                            commonwealth: { price: 29800, schools: 10, rec: [5,10] },
                            usa: { price: 58000, schools: 10, rec: [8,12] },
                            global: { price: 75000, schools: 20, rec: [15,20] }
                        }
                    },
                    masters: {
                        label: '硕士',
                        targetApplicationYear: 16,
                        grades: [
                            { value: 13, label: '大一' }, { value: 14, label: '大二' },
                            { value: 15, label: '大三' }, { value: 16, label: '大四' }
                        ],
                        regions: {
                            commonwealth: { price: 19800, schools: 7, rec: [5,7] },
                            usa: { price: 39800, schools: 10, rec: [8,10] },
                            global: { price: 55000, schools: 17, rec: [12,17] }
                        }
                    },
                    phd: {
                        label: '博士',
                        targetApplicationYear: 17,
                        grades: [
                            { value: 15, label: '大三' }, { value: 16, label: '大四' },
                            { value: 17, label: '研究生' }
                        ],
                        regions: {
                            commonwealth: { price: 39800, schools: 5, rec: [3,5] },
                            usa: { price: 39800, schools: 5, rec: [3,5] },
                            global: { price: 68000, schools: 10, rec: [5,8] }
                        }
                    }
                }
            },

            // State
            state: {
                stage: 'undergrad',
                grade: 10,
                region: 'commonwealth',
                schools: 10,
                extras: {}
            },

            init() {
                this.addEventListeners();
                this.updateGradeOptions();
                this.update();
            },

            addEventListeners() {
                this.stageBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.state.stage = e.target.dataset.value;
                        this.updateActiveButton(this.stageBtns, this.state.stage);
                        this.updateGradeOptions();
                        this.state.region = 'commonwealth';
                        this.updateActiveButton(this.regionBtns, this.state.region);
                        const baseConfig = this.config.stages[this.state.stage].regions[this.state.region];
                        this.state.schools = baseConfig.schools;
                        this.schoolCountSlider.value = this.state.schools;
                        this.update();
                    });
                });
                
                this.currentGradeSelect.addEventListener('change', (e) => {
                    this.state.grade = parseInt(e.target.value);
                    this.update();
                });

                this.regionBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.state.region = e.target.dataset.value;
                        this.updateActiveButton(this.regionBtns, this.state.region);
                        this.update();
                    });
                });

                this.schoolCountSlider.addEventListener('input', (e) => {
                    this.state.schools = parseInt(e.target.value);
                    this.update();
                });

                this.extraServicesContainer.addEventListener('change', (e) => {
                    if (e.target.type === 'checkbox') {
                        this.state.extras[e.target.id] = e.target.checked;
                        this.update();
                    }
                });
            },

            updateActiveButton(buttons, activeValue) {
                buttons.forEach(b => {
                    if (b.dataset.value === activeValue) {
                        b.classList.add('bg-blue-500', 'text-white');
                        b.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                    } else {
                        b.classList.remove('bg-blue-500', 'text-white');
                        b.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-800', 'dark:text-gray-200');
                    }
                });
            },

            updateGradeOptions() {
                const stageConfig = this.config.stages[this.state.stage];
                this.currentGradeSelect.innerHTML = stageConfig.grades.map(g => `<option value="${g.value}">${g.label}</option>`).join('');
                this.state.grade = stageConfig.grades[0].value;
            },

            update() {
                let total = 0;
                let services = [];
                const stageConfig = this.config.stages[this.state.stage];
                const regionConfig = stageConfig.regions[this.state.region];

                // Update UI elements
                this.schoolCountLabel.textContent = this.state.schools;
                this.updateSliderTrack();
                this.updateExtraServices();

                // --- Core Application Service ---
                total += regionConfig.price;
                services.push({
                    title: `${stageConfig.label}申请核心服务`,
                    items: [
                        `申请地区: ${this.state.region === 'commonwealth' ? '英联邦' : this.state.region === 'usa' ? '美国' : '全球联申'}`,
                        `包含院校数量: ${regionConfig.schools}所`,
                        `标准服务流程 (SOP) 全程跟进`
                    ]
                });

                // --- Extra Schools ---
                if (this.state.schools > regionConfig.schools) {
                    const extra = this.state.schools - regionConfig.schools;
                    const extraCost = extra * this.config.extraSchool;
                    total += extraCost;
                    services.push({
                        title: '额外院校申请',
                        items: [`增加 ${extra} 所院校`]
                    });
                }

                // --- Early Planning ---
                const planningYears = stageConfig.targetApplicationYear - this.state.grade;
                if (planningYears > 0) {
                    let paidYears = planningYears;
                    let freeYears = 0;
                    let planningDetails = [`总规划时长: ${planningYears} 年 (从当前年级到申请季开始)`];

                    if (this.state.stage === 'undergrad') {
                        freeYears = 1;
                        paidYears = Math.max(0, planningYears - 1);
                        planningDetails.push(`其中包含 ${freeYears} 年免费规划`);
                    }
                    
                    if (paidYears > 0) {
                        const planningCost = paidYears * this.config.planningPerYear;
                        total += planningCost;
                        planningDetails.push(`付费规划时长: ${paidYears} 年`);
                    }
                    
                    services.push({
                        title: '长期规划服务',
                        items: planningDetails
                    });
                }
                
                // --- Extra Services ---
                let extraServiceItems = [];
                for (const key in this.state.extras) {
                    if (this.state.extras[key] && this.config.extraServices[key]) {
                        const service = this.config.extraServices[key];
                        total += service.price;
                        extraServiceItems.push(service.label);
                    }
                }
                if (extraServiceItems.length > 0) {
                    services.push({
                        title: '额外选购服务',
                        items: extraServiceItems
                    });
                }

                this.totalPrice.textContent = `¥${total.toLocaleString()}`;
                this.serviceList.innerHTML = services.map(service => `
                    <div class="mb-3">
                        <h4 class="font-semibold text-gray-800 dark:text-gray-200">${service.title}</h4>
                        <ul class="pl-4 mt-1 space-y-1">
                            ${service.items.map(item => `<li class="text-sm text-gray-600 dark:text-gray-400 flex items-start"><span class="text-blue-500 mr-2 mt-1">&#8227;</span><span>${item}</span></li>`).join('')}
                        </ul>
                    </div>
                `).join('');
            },
            
            updateSliderTrack() {
                const slider = this.schoolCountSlider;
                const min = parseInt(slider.min);
                const max = parseInt(slider.max);
                
                const regionConfig = this.config.stages[this.state.stage].regions[this.state.region];
                const [recMin, recMax] = regionConfig.rec;

                const recMinPercent = (recMin - min) / (max - min) * 100;
                const recMaxPercent = (recMax - min) / (max - min) * 100;

                const isDark = document.documentElement.classList.contains('dark');
                const trackColor = isDark ? '#4a5568' : '#e2e8f0';
                const recommendColor = isDark ? '#3b82f6' : '#93c5fd';

                slider.style.background = `linear-gradient(to right, 
                    ${trackColor} 0%, 
                    ${trackColor} ${recMinPercent}%, 
                    ${recommendColor} ${recMinPercent}%, 
                    ${recommendColor} ${recMaxPercent}%, 
                    ${trackColor} ${recMaxPercent}%, 
                    ${trackColor} 100%)`;
            },
            updateExtraServices() {
                const phdServiceHTML = `<label class="flex items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg cursor-pointer">
                    <input type="checkbox" id="rpCoaching" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <span class="ml-3 text-gray-700 dark:text-gray-300">研究计划 (RP) 深度辅导 (+ ¥${this.config.extraServices.rpCoaching.price.toLocaleString()})</span>
                </label>`;

                if (this.state.stage === 'phd') {
                    // 如果是博士阶段，并且容器里还没有这个选项，就添加它
                    if (!this.extraServicesContainer.querySelector('#rpCoaching')) {
                        this.extraServicesContainer.innerHTML = phdServiceHTML;
                    }
                    // 确保复选框的勾选状态与我们的 state 一致
                    const checkbox = this.extraServicesContainer.querySelector('#rpCoaching');
                    if (checkbox) {
                        checkbox.checked = !!this.state.extras.rpCoaching;
                    }
                } else {
                    // 如果不是博士阶段，就清空
                    this.extraServicesContainer.innerHTML = '';
                    // 同时清空 state 里的状态
                    this.state.extras.rpCoaching = false;
                }
            }
        };

        calculator.init();
    });
    </script>

</MainLayout>